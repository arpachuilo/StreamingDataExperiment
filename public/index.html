<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Streaming Selection</title>

    <!-- Bootstrap core JavaScript -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/tether/tether.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom fonts for this template -->
    <link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Cabin:700' rel='stylesheet' type='text/css'>

    <!-- Custom styles for this template -->
    <link rel='stylesheet' href='style.css'>
    <link href="css/grayscale.css" rel="stylesheet">

    <!-- JS Files -->
    <script src='js/grayscale.js'></script>
    <script src='/libs/d3.min.js'></script>
    <script src='/libs/moment.min.js'></script>
    <script src='/libs/moment-duration-format.js'></script>
    <script src='./scripts/util.js'></script>
    <script src='./scripts/StreamingChart.js'></script>
    <script src='./scripts/TimeControl.js'></script>
    <script src='./scripts/LassoProxy.js'></script>
    <script src='./scripts/WholeScreenProxy.js'></script>
    <script src='./scripts/BarAggregation.js'></script>
    <script src='./scripts/HeatmapAggregation.js'></script>
    <script src='./scripts/Tooltip.js'></script>

    <!-- Temporary navbar container fix -->
    <style>
    .navbar-toggler {
        z-index: 1;
    }

    @media (max-width: 576px) {
        nav > .container {
            width: 100%;
        }
    }
    </style>

</head>

<body id="page-top">

    <!-- Navigation -->
    <nav id="mainNav" class="navbar fixed-top navbar-toggleable-md navbar-light">
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarExample" aria-controls="navbarExample" aria-expanded="false" aria-label="Toggle navigation">
            Menu <i class="fa fa-bars"></i>
        </button>
        <div class="container">
            <a class="navbar-brand" href="#page-top">HOME</a>
            <div class="collapse navbar-collapse" id="navbarExample">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#about">Introduction</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#download">Task</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#timeframe">Time Frame</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#instructions">Instructions</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#demo">Demo</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#contact">Begin Study</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Intro Header -->
    <header class="masthead">
        <div class="intro-body">
            <div class="container">
                <div class="row">
                    <div class="col-md-8 offset-md-2">
                        <h2 >Analysis of Interaction Techniques for Streaming Data</h2>
                        <p class="intro-text">Investigators: Nicolas Bain, Andrew Pachuilo, Zhi Chai </br> Graduate Students in the Dept. of Computer Science, Texas A&M</p>
                        <a href="#about" class="btn btn-circle page-scroll">
                            <i class="fa fa-angle-double-down animated"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- About Section -->
    <section id="about" class="container content-section text-center">
        <div class="row">
            <div class="col-lg-8 offset-md-2">
                <h2>Introduction</h2>
                <p>The purpose of this page is to provide you with information that may affect your decision whether or not to participate in this research study. If you agree, you will be asked to participate in a research study that tests users situational awareness while monitoring a streaming data set. This is done by asking participants to answer both target selection based questions and "big picture" questions, which are generally related to data aggregation.</p>
            </div>
        </div>
    </section>

    <!-- Download Section -->
    <section id="download" class="content-section text-center">
        <div class="download-section">
            <div class="container" id="downloadtest">
                <div class="col-lg-8 offset-md-2">
                    <h2>What will I be asked to do?</h2>
                    <p>If you choose to participate in this study, we will collect data on your response time and accuracy while you answer questions related to the presented streaming data visualization. Specifically, you will be asked questions related to target selection and data aggregation. Target selection is explained below, whereas the data aggregation questions will have to do with either a heatmap or a bar chart. Participants should have an understanding of how to read these before they proceed. The data we gather will be kept confidential and no identifiers linking you to this information will be included in any report that will be kept or published.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="timeframe" class="content-section text-center">
        <div class="timeframe-section">
            <div class="container">
                <div class="col-lg-8 offset-md-2">
                    <h2>What is the projected time frame?</h2>
                    <p>This study should take no more than 40 minutes of your time. Please set aside adequate time and complete the study in one sitting.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="instructions" class="content-section text-center">
        <div class="instructions-section">
            <div class="container" id="instructionstest">
                <div class="col-lg-8 offset-md-2">
                    <h2>Instructions</h2>
                    <p>In order to complete this study, participants must know how to use the selection techniques and how to utilize the time control mechanic. There are two types of selection techniques offered to the participants; a lasso proxy and a whole screen proxy.
                    </p>
                    <p>
                    The <b>lasso proxy</b> works by users clicking and holding their mouse button while they outline a region. Everything in the selected region then has a proxy (ghost) of itself created and displayed on the screen. This proxy target will not move with time, which makes target selection easier. Performing the lasso action again will clear the old targets and create proxy targets of whatever data is in the new region.
                    </p>
                    <p>The <b>whole screen proxy</b> will create a proxy of every target currently displayed on the scatterplot. Participants activate this proxy by hitting the left <b>control key</b> key on their keyboard. Hitting <b>control key</b> again will clear the original proxy targets and activate new proxy targets whatever data is currently on the scatterplot. You can also press <b>alt key</b> to clear proxy targets.
                    </p>
                    <p>The <b>time control mechanics</b> are rather straight forward. There is a play and pause button, a skip forward button, and an icon for the current time position, which can be moved by participants. These time control mechanics work just time control would work for a normal video. The leftmost time is the beggining time for the stream, the center time is where the stream is currently located, and the right most time is 'realtime,' as in the current max time for the stream. This will increase as time goes on. Participants are free to skip back and forth in each of the data streams. Perform this action if you are unable to answer the assigned question by the end of the stream.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <section id="demo" class="content-section text-center">
        <div class="demo-section">
            <div class="container" id="demotest">
                <div>
                  <h2>Demonstration</h2>
                  <p>Before we can let you continue we want to make sure you test out all of the methods and their combinations. To do this simply use the dropdrowns to change the aggregation and proxy methods then use the proxy method and click one of the dots. You must do this for each combination.</p>

                  <div>
                    <span>Aggregation: </span>
                    <select id='aggregationValue' onchange='onAggregationChange()'>
                      <option value='HeatmapAggregation'>Heatmap</option>
                      <option value='BarAggregation'>Bar Chart</option>
                    </select>
                    <span>Proxy Method: </span>
                    <select id='proxyValue' onchange='onProxyChange()'>
                      <option value='LassoProxy'>Lasso Proxy</option>
                      <option value='WholeScreenProxy'>WholeScreen Proxy</option>
                    </select>
                  </div>

                  <div>
                    <div class='row charts'>
                      <div class='col-4' style="padding: 0 0 0 0;">
                        <div id='aggChart'></div>
                      </div>
                      <div class='col-8' style="padding: 0 0 0 0;">
                        <div id='testChart'></div>
                      </div>
                    </div>
                    <div class='row'>
                      <div class='col-4'>&nbsp;</div>
                      <div class='col-8'>
                        <div id='tc'></div>
                      </div>
                    </div>
                  </div>

                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="container content-section text-center">
        <div class="row">
            <div class="col-lg-8 offset-md-2">
                <h2>DON'T REFRESH THE BROWSER DURING THE STUDY</h2>
                <h3>Some things may take awhile to load</h3>

                <h3>Click the button below to begin the study</h3>

                <input type="submit" value="Start User Study" onclick="cont()" class="btn btn-default btn-lg" />
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container text-center">
            <p>Copyright &copy; Nicolas Bain, Andrew Pachuilo, Zhi Chai</p>
        </div>
    </footer>

    <script>

    var test = {
      HeatmapAggregationLassoProxy: true,
      HeatmapAggregationWholeScreenProxy: true,
      BarAggregationLassoProxy: true,
      BarAggregationWholeScreenProxy: true
    }

    function cont () {
      var pass = true
      Object.keys(test).forEach(function (k) {
        pass = pass && test[k]
      })

      if (pass) {
        window.location.href = 'test.html'
      } else {
        alert('Please test out all 4 possible combinations in the demo')
      }
    }

    function onAggregationChange () {
      testChart.setAggregation(window[document.getElementById('aggregationValue').value](d3.select('#aggChart')))
    }

    function onProxyChange () {
      var fn = window[document.getElementById('proxyValue').value]
      testChart.cursor(fn)
    }

    var data = []
    var n = +(new Date())

    var testChart = StreamingChart(d3.select('#testChart'))
      .x('time')
      .y('y')
      .cursor(LassoProxy)
      .clickHandler(function (d, i, c) {
        if (c === 'proxy') {
          test[document.getElementById('aggregationValue').value + document.getElementById('proxyValue').value] = true
        }
      })
      .setAggregation(HeatmapAggregation(d3.select('#aggChart')))
      .setTimeControls(TimeControl(d3.select('#tc')))
      .setNow(n)
      .start()

    d3.interval(function (e) {
      data.push({
        y: Math.random() * 10,
        time: +(new Date())
      })

      if (data.length > 1000) {
        data.shift()
      }
    }, 1000)

    </script>

</body>
</html>
